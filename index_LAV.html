<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Travel</title>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">

	<link href="https://fonts.googleapis.com/css?family=Gloria+Hallelujah|Pacifico" rel="stylesheet">

	<link rel="stylesheet" type="text/css" href="assets/css/style.css">

	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
</head>
<body>
	
<div class="container">


	<h1>Tripzilla</h1>

	<p>Live. Love. Travel.</p>

</div>


<div class="divider"></div>

</br></br>


<div class="container">

    <div class="row">

        <div class="col s12 m12">

          <div class="card blue-grey darken-1">
<div id="replace">
            <div class="card-content white-text">

              <span class="card-title"><i class="material-icons">flight</i> Search for Flight</span>


                <div class="row">
    <form class="col s12">

      <div class="row">
        <div class="input-field col s12">
          <textarea id="flyingTo" class="materialize-textarea"></textarea>
          <label for="textarea1"><i class="material-icons">flight_takeoff</i> Flying To</label>
        </div>
      </div>


      <div class="row">
        <div class="input-field col s12">
          <textarea id="flyingFrom" class="materialize-textarea"></textarea>
          <label for="textarea1"><i class="material-icons">flight_land</i> Flying From</label>
        </div>
      </div>

      <div class="row">
        <div class="input-field col s6">
          <textarea id="departing" class="materialize-textarea"></textarea>
          <label for="textarea1"><i class="material-icons">flight_takeoff</i> Departing</label>
        </div>

        <div class="input-field col s6">
          <textarea id="returning" class="materialize-textarea"></textarea>
          <label for="textarea1"><i class="material-icons">flight_land</i> Returning</label>
        </div>
      </div>

		<div class="row">
		  <div class="input-field col s6" id="adult">
		    <select id="adult">
		      <option value="" disabled selected>How Many Tickets?</option>
		      <option value="1">+1</option>
		      <option value="2">+2</option>
		      <option value="3">+3</option>
		      <option value="4">+4</option>
		      <option value="5">+5</option>
		      <option value="6">+6</option>
		    </select>
		    <label><i class="material-icons">group_add</i> Adult (18+)</label>
		  </div>

		  <div class="input-field col s6" id="children">
		    <select>
		      <option value="" disabled selected>How Many Tickets?</option>
		      <option value="1">+1</option>
		      <option value="2">+2</option>
		      <option value="3">+3</option>
		      <option value="4">+4</option>
		      <option value="5">+5</option>
		      <option value="6">+6</option>
		    </select>
		    <label><i class="material-icons">group_add</i> Children</label>
		  </div>

		</div>  


<div class="row">
	<div class="input-field col s3">
		<a class="waves-effect waves-light btn" id="search">Search</a>
	</div>
</div>


    </form>
  			</div>

			</div>
</div>
  <div id="result">
      <div class="card-content">
      <p id="resultHead">Search Results</p>
    </div>
    <div class="card-tabs">
      <ul class="tabs tabs-fixed-width" id="tabHead">
        <li class="tab"><a href="#test4">Flights</a></li>
        <li class="tab"><a href="#test5">Points of Interest</a></li>
      </ul>
    </div>
    <div class="card-content blue lighten-4">

      <div id="test4">

		  <div class="col s12 m7">
		    <div class="card horizontal">
		      <div class="card-stacked">

		      	<div class="card-content" id="flightInfo">

					<div class="row">
						<div class="col m3">
				          <p id="totalCost">Total Cost: <span id="totalPrice">N/A</span></p>
				        </div>  
				        <div class="col m9">
				          <a class="waves-effect waves-light btn" id="bigSelect">SELECT</a>
				        </div>  
				    </div>      

		        </div>

		        <div class="divider"></div>

		        <div class="card-content" id="flightInfo">
		        	<div class="row">
		        		<div class="col m3">
		        			<span id="airlineDepart">Departure Airline</span>
		        		</div>
						<div class="col m5" id="timeInfo">
							<div class="row">
								<span>Departure Time</span>
							</div>
							<div class="row">
								<span>Arrival Time</span>
							</div>
						</div>
						<div class="col m3" id="airportInfo">
							<div class="row">
								<span>Departure Airport</span>
							</div>
							<div class="row">
								<span>Arrival Airport</span>
							</div>
						</div>
		        	</div>
	                
	                <div class="row">	
	                	<div class="col m3">
	                		<p id="tripTotal">Total Trip: <span>N/A</span></p>
	                	</div>
						<div class="col m9">
		          			<a href="#" id="selectLink">Select this Departure</a>
		          		</div>	
		          	</div>	
		        </div>

		        <div class="divider"></div>

		        <div class="card-content" id="flightInfo">
		        	<div class="row">
		        		<div class="col m3">
		        			<span id="airlineDepart">Departure Airline</span>
		        		</div>
						<div class="col m5" id="timeInfo">
							<div class="row">
								<span id="timeDep">Departure Time</span>
							</div>
							<div class="row">
								<span id="timeArr">Arrival Time</span>
							</div>
						</div>
						<div class="col m3" id="airportInfo">
							<div class="row">
								<span id="airportDep">Departure Airport</span>
							</div>
							<div class="row">
								<span id="airportArr">Arrival Airport</span>
							</div>
						</div>
		        	</div>
	                
	                <div class="row">	
	                	<div class="col m3">
	                		<p id="tripTotal">Total Trip: <span id="trip">N/A</span></p>
	                	</div>
						<div class="col m9">
		          			<a href="#" id="selectLink">Select this Arrival</a>
		          		</div>	
		          	</div>	
		        </div>

		        </div>
		      </div>
		    </div>
		  </div>

   

      <div id="test5">

    		<div class="col s12 m7">
				<div class="card horizontal">
				    <div class="card-stacked">

				       <div class="card-content" id="flightInfo">
				        	<div class="row">
								<div class="col m3">
						          <p id="poiTab">Point of Interest: <span id="poi">N/A</span></p>
						        </div>  
						        <div class="col m9">
						          <a class="waves-effect waves-light btn" id="bigSelect">SELECT</a>
						        </div>  
				    		</div>  
				        </div>

		        <div class="divider"></div>

				       <div class="card-content" id="flightInfo">
				        	<div class="row">
								<div class="col m3">
						          <p id="poiTab">Information: <span id="poiInfo">N/A</span></p>
						        </div>   
				    		</div>  
				        </div>

				    </div>
				</div>
			</div> 

       </div>

   	</div>
   	</div>
        </div>

    </div>

</div>



	
	<script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>

	<script>
	$(document).ready(function() {
		//$('select').material_select();
		$("#result").fadeOut();
var ele = " ";
var ele1=" ";
var adultTicket;
  $("#search").on("click",function()
	{
		$("#replace").fadeOut();
$("#result").fadeIn();
		ele = $("#flyingFrom").val();
		ele1=$("#flyingTo").val();
		adultTicket=$("#adult option:selected").val();

console.log(ele);

  var FlightRequest = {
      "request": {
        "slice": [
          {
            "origin": ele,
            "destination": ele1,
            "date": "2017-09-20"
          }
        ],
        "passengers": {
          "adultCount": 1,
          "infantInLapCount": 0,
          "infantInSeatCount": 0,
          "childCount": 0,
          "seniorCount": 0
        },
        "solutions": 2,
        "refundable": false
      }
    };
    // Example queryURL for Giphy API
    // var queryURL = "https://www.googleapis.com/qpxExpress/v1/trips/search?api_key=AIzaSyBIjHWMEe33nbvDxx8C0z_ETWmoCm1FuTY,request.slice[].origin=NYC,request.slice[].destination=LGA,request.slice[].date=9/11/2017";

    // $.ajax({
    //   url: queryURL,
    //   method: 'POST'
    // }).done(function(response) {
    //   console.log(response);
    // });

$.ajax({
     type: "POST",
     //Set up your request URL and API Key.
     // url: "https://www.googleapis.com/qpxExpress/v1/trips/search?key=AIzaSyBIjHWMEe33nbvDxx8C0z_ETWmoCm1FuTY", 
     url:"https://www.googleapis.com/qpxExpress/v1/trips/search?key=AIzaSyA7KqrZYamIJ2fEbygqESoGiBFtqRqq98g",
     contentType: 'application/json', // Set Content-type: application/json
     dataType: 'json',
     // The query we want from Google QPX, This will be the variable we created in the beginning
     data: JSON.stringify(FlightRequest),
     success: function (data) {
      //Once we get the result you can either send it to console or use it anywhere you like.
      console.log(data);
     
      var myJSON = JSON.stringify(data.trips.tripOption[0].pricing[0].saleTotal);

var myAircraftName=JSON.stringify(data.trips.data.aircraft[0].name);
var myOrigin=JSON.stringify(data.trips.data.airport[1].name);
var myDest=JSON.stringify(data.trips.data.airport[0].name);
      //console.log(myJSON);

      // document.getElementById("demo").innerHTML = myJSON;

      // document.getElementById("demo1").innerHTML = myAircraftName;

      // document.getElementById("origin").innerHTML = myOrigin;

      // document.getElementById("dest").innerHTML = myDest;
      console.log(data.trips.tripOption.length)
      for(var i = 0; i< data.trips.tripOption.length; i++)
      { 
      	if(i === 0)
      	{
      	// console.log(JSON.stringify(data.trips.tripOption[i].pricing[i].saleTotal));
      	console.log(JSON.stringify(data.trips.tripOption[i].saleTotal));
      	// console.log(JSON.stringify(data.trips.tripOption[i].slice[i].segment[i].duration));
      	console.log(JSON.stringify(data.trips.tripOption[i].slice[i].duration));
      console.log(JSON.stringify(data.trips.tripOption[i].slice[i].segment[i].flight.carrier));
      console.log(JSON.stringify(data.trips.tripOption[i].slice[i].segment[i].flight.number));
      console.log(JSON.stringify(data.trips.tripOption[i].slice[i].segment[i].leg[i].arrivalTime));
      console.log(JSON.stringify(data.trips.tripOption[i].slice[i].segment[i].leg[i].departureTime));
      console.log(JSON.stringify(data.trips.tripOption[i].slice[i].segment[i].leg[i].destination));
      console.log(JSON.stringify(data.trips.tripOption[i].slice[i].segment[i].leg[i].origin));
  }
if(i>=1)
{
	console.log(JSON.stringify(data.trips.tripOption[i].saleTotal));
	console.log(JSON.stringify(data.trips.tripOption[i].slice));
  console.log(JSON.stringify(data.trips.tripOption[i].slice.length));
for(var j=0; j < data.trips.tripOption[i].slice[0].segment.length; j++)
{
  //console.log(JSON.stringify(data.trips.tripOption[i].slice[0].segment.length));
	console.log(JSON.stringify(data.trips.tripOption[1].slice[0].segment[j].duration));
	console.log(JSON.stringify(data.trips.tripOption[i].slice[0].segment[0].connectionDuration));
	console.log(JSON.stringify(data.trips.tripOption[1].slice[0].segment[j].leg));
  //console.log(JSON.stringify(data.trips.tripOption[1].slice[0].segment[j].duration));
  console.log(JSON.stringify(data.trips.tripOption[1].slice[0].segment[j].leg[0].arrivalTime));
   console.log(JSON.stringify(data.trips.tripOption[1].slice[0].segment[j].leg[0].departureTime));
  console.log(JSON.stringify(data.trips.tripOption[1].slice[0].segment[j].leg[0].origin));
 console.log(JSON.stringify(data.trips.tripOption[1].slice[0].segment[j].leg[0].destination));
  	}
}

      }
      

//window.location.href = "results.html";
    },
      error: function(){
       //Error Handling for our request
       alert("Access to Google QPX Failed.");
     }
    });


});

  

	})
	</script>

</body>
</html>